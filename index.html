<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gray Cardinal ‚Äî –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω</title>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;600;700&family=Golos+Text:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#141414; --frame:#1f1f1f; --frame2:#252525;
  --border:#2a2a2a; --border2:#383838;
  --katya:#a82035; --katya2:#c42a43;
  --erik:#1e3f72;  --erik2:#2a5499;
  --gold:#c09a4a;  --gold2:#e0be78;
  --green:#2a6645; --green2:#3d9963;
  --text:#e2ddd8;  --text2:#9a9088; --text3:#5a5248; --white:#f5f2ee;
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);font-family:'Golos Text',sans-serif;color:var(--text);min-height:100vh}

/* ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ */
.topbar{position:sticky;top:0;z-index:200;background:rgba(14,14,14,.97);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);padding:0 24px;height:52px;display:flex;align-items:center;justify-content:space-between}
.tb-logo{font-family:'Unbounded',sans-serif;font-size:12px;font-weight:700;color:var(--white);letter-spacing:.1em}
.tb-logo span{color:var(--gold2)}
.tb-actions{display:flex;gap:8px}
.btn{font-size:11px;font-weight:600;padding:6px 14px;border-radius:5px;cursor:pointer;border:none;transition:all .15s;letter-spacing:.03em}
.btn-add{background:var(--gold);color:#0e0c06}
.btn-add:hover{background:var(--gold2)}
.btn-save{background:rgba(42,102,69,.3);color:#7ad4a4;border:1px solid rgba(42,102,69,.5)}
.btn-save:hover{background:rgba(42,102,69,.5)}
.btn-reset{background:rgba(60,60,60,.3);color:var(--text2);border:1px solid var(--border2)}
.btn-reset:hover{background:rgba(80,80,80,.4)}

/* ‚îÄ‚îÄ FILTERS ‚îÄ‚îÄ */
.filters{padding:10px 24px;border-bottom:1px solid var(--border);background:rgba(0,0,0,.15);display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.filter-label{font-size:9px;font-weight:700;letter-spacing:.2em;text-transform:uppercase;color:var(--text3);margin-right:4px}
.filter-select{background:rgba(0,0,0,.3);border:1px solid var(--border2);color:var(--text2);font-size:11px;padding:4px 10px;border-radius:4px;cursor:pointer;font-family:'Golos Text',sans-serif;outline:none}
.filter-select:hover{border-color:var(--border2);color:var(--text)}
.filter-sep{width:1px;height:20px;background:var(--border)}

/* ‚îÄ‚îÄ WEEK TABS ‚îÄ‚îÄ */
.week-tabs{padding:0 24px;border-bottom:1px solid var(--border);display:flex;gap:0;background:var(--frame)}
.week-tab{padding:12px 20px;font-size:11px;font-weight:600;color:var(--text3);cursor:pointer;border-bottom:2px solid transparent;transition:all .15s;white-space:nowrap;letter-spacing:.03em}
.week-tab:hover{color:var(--text2)}
.week-tab.active{color:var(--gold2);border-bottom-color:var(--gold)}
.week-add-tab{padding:12px 16px;font-size:18px;color:var(--text3);cursor:pointer;transition:color .15s}
.week-add-tab:hover{color:var(--gold2)}

/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
.main{padding:16px 24px 100px;max-width:2800px}

/* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
.cp-table{width:100%;border-collapse:separate;border-spacing:50;border:50px solid var(--border);border-radius:12px;overflow:hidden;min-width:1200px}
.cp-table thead th{background:#0e0e0e;padding:10px 12px;font-size:8.5px;font-weight:1400;letter-spacing:.18em;text-transform:uppercase;color:var(--text3);text-align:left;border-bottom:10px solid var(--border2);white-space:nowrap;position:sticky;top:20px;z-index:10}
.cp-table thead th:not(:last-child){border-right:1px solid var(--border)}

/* ROW */
.cp-table tbody tr{transition:background .1s}
.cp-table tbody tr:hover td{background:rgba(255,255,255,.02) !important}
.cp-table tbody td{padding:9px 12px;vertical-align:middle;border-bottom:1px solid var(--border);font-size:12px}
.cp-table tbody tr:last-child td{border-bottom:none}
.cp-table tbody td:not(:last-child){border-right:1px solid var(--border)}
.row-odd td{background:var(--frame)}
.row-even td{background:rgba(0,0,0,.1)}

/* WEEK SEPARATOR */
.week-row td{background:#0a0a0a !important;padding:7px 12px;font-size:8.5px;font-weight:700;letter-spacing:.22em;text-transform:uppercase;color:var(--text3);border-bottom:10px solid var(--border2)}
.week-row td span{background:var(--gold);color:#0e0c06;padding:1px 7px;border-radius:3px;font-size:8px}

/* ‚îÄ‚îÄ CELL TYPES ‚îÄ‚îÄ */
.c-num{font-family:'Unbounded',sans-serif;font-size:10px;font-weight:700;color:var(--text3);text-align:center;width:40px}
.c-date{width:80px;white-space:nowrap}
.date-day{font-size:12px;color:var(--text2);font-weight:500}
.date-name{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-top:2px}
.date-name.weekend{color:var(--gold)}

/* EDITABLE */
[contenteditable]{outline:none;border-radius:4px;padding:2px 4px;transition:background .12s;min-width:20px;display:inline-block}
[contenteditable]:hover{background:rgba(255,255,255,.04)}
[contenteditable]:focus{background:rgba(255,255,255,.07);box-shadow:0 0 0 1px rgba(192,154,74,.3)}
.topic-title{font-size:13px;font-weight:600;color:var(--white);line-height:1.35;display:block}
.topic-sub{font-size:11px;color:var(--text3);line-height:1.4;display:block;margin-top:2px}

/* DROPDOWN SELECT CELLS */
.cell-select{position:relative}
.custom-select{position:relative;display:inline-block;width:100%}
.cs-trigger{display:flex;align-items:center;justify-content:space-between;gap:6px;cursor:pointer;border-radius:5px;padding:4px 8px;transition:background .12s;border:1px solid transparent;min-height:28px}
.cs-trigger:hover{background:rgba(255,255,255,.05);border-color:var(--border2)}
.cs-arrow{font-size:9px;color:var(--text3);transition:transform .15s;flex-shrink:0}
.custom-select.open .cs-arrow{transform:rotate(180deg)}
.cs-dropdown{position:absolute;top:calc(100% + 4px);left:0;z-index:300;background:#1a1a1a;border:1px solid var(--border2);border-radius:7px;min-width:160px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.5);opacity:0;transform:translateY(-4px);pointer-events:none;transition:all .14s}
.custom-select.open .cs-dropdown{opacity:1;transform:translateY(0);pointer-events:all}
.cs-option{padding:8px 12px;font-size:12px;cursor:pointer;transition:background .1s;display:flex;align-items:center;gap:8px;color:var(--text2)}
.cs-option:hover{background:rgba(255,255,255,.06);color:var(--white)}
.cs-option.selected{color:var(--white)}

/* BADGES */
.badge{display:inline-flex;align-items:center;gap:4px;font-size:10px;font-weight:600;padding:3px 8px;border-radius:4px;white-space:nowrap}
/* Status */
.s-idea  {background:rgba(90,63,138,.22);border:1px solid rgba(124,91,181,.35);color:#c4a8f0}
.s-tz    {background:rgba(192,154,74,.18);border:1px solid rgba(192,154,74,.38);color:#e0be78}
.s-prod  {background:rgba(30,63,114,.22);border:1px solid rgba(42,84,153,.4);color:#88b2de}
.s-done  {background:rgba(42,102,69,.2);border:1px solid rgba(42,102,69,.4);color:#7ad4a4}
.s-pub   {background:rgba(168,32,53,.18);border:1px solid rgba(196,42,67,.38);color:#e8909a}
/* Rubric */
.r-life  {background:rgba(192,154,74,.15);border:1px solid rgba(192,154,74,.25);color:#e0be78}
.r-prod  {background:rgba(42,102,69,.18);border:1px solid rgba(42,102,69,.3);color:#7ad4a4}
.r-promo {background:rgba(168,32,53,.18);border:1px solid rgba(168,32,53,.3);color:#e8909a}
.r-ugc   {background:rgba(90,63,138,.18);border:1px solid rgba(90,63,138,.3);color:#c4a8f0}
.r-edu   {background:rgba(30,63,114,.18);border:1px solid rgba(30,63,114,.3);color:#88b2de}
.r-bts   {background:rgba(80,60,20,.25);border:1px solid rgba(140,100,30,.3);color:#d4a860}
.r-news  {background:rgba(50,50,50,.3);border:1px solid rgba(80,80,80,.3);color:#c0c0c0}
.r-eng   {background:rgba(36,120,80,.18);border:1px solid rgba(36,120,80,.3);color:#80dfa8}
/* Format */
.f-post  {background:rgba(255,255,255,.06);border:1px solid var(--border2);color:var(--text2)}
.f-car   {background:rgba(30,63,114,.12);border:1px solid rgba(30,63,114,.25);color:#88b2de}
.f-reel  {background:rgba(168,32,53,.12);border:1px solid rgba(168,32,53,.25);color:#e8909a}
.f-stor  {background:rgba(90,63,138,.12);border:1px solid rgba(90,63,138,.25);color:#c4a8f0}
.f-info  {background:rgba(192,154,74,.1);border:1px solid rgba(192,154,74,.22);color:#e0be78}
.f-vid   {background:rgba(42,102,69,.12);border:1px solid rgba(42,102,69,.25);color:#7ad4a4}
/* Who */
.w-k{background:var(--katya2);color:#fff;font-size:8px;letter-spacing:.1em;text-transform:uppercase;padding:2px 7px;border-radius:3px}
.w-e{background:var(--erik2);color:#fff;font-size:8px;letter-spacing:.1em;text-transform:uppercase;padding:2px 7px;border-radius:3px}
/* Platform */
.p-vk {background:rgba(0,119,255,.15);border:1px solid rgba(0,119,255,.25);color:#6da8ff}
.p-tg {background:rgba(36,161,222,.12);border:1px solid rgba(36,161,222,.2);color:#7fd8f8}
.p-ig {background:rgba(192,74,120,.12);border:1px solid rgba(192,74,120,.2);color:#f0a0c0}
.p-pin{background:rgba(189,8,28,.1);border:1px solid rgba(189,8,28,.2);color:#ff8090}

/* Asset checks */
.asset-cell{display:flex;flex-direction:column;gap:4px}
.asset-row{display:flex;align-items:center;gap:5px;font-size:10.5px;color:var(--text2)}
.asset-check{width:16px;height:16px;border-radius:3px;border:1.5px solid rgba(192,154,74,.3);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:9px;transition:all .12s;flex-shrink:0}
.asset-check.checked{background:rgba(42,102,69,.35);border-color:rgba(42,102,69,.6);color:#7ad4a4}
.asset-check:hover{border-color:rgba(192,154,74,.6)}

/* Platform tags multi */
.plat-tags{display:flex;flex-wrap:wrap;gap:3px}
.plat-toggle{font-size:9px;font-weight:700;padding:2px 7px;border-radius:3px;cursor:pointer;transition:opacity .12s;user-select:none}
.plat-toggle.off{opacity:.3;filter:grayscale(.6)}
.plat-toggle:hover{opacity:.85 !important}

/* Note */
.note-cell{font-size:11px;color:var(--text3);font-style:italic;min-width:100px}

/* Row actions */
.row-actions{display:flex;gap:4px;opacity:0;transition:opacity .12s}
tr:hover .row-actions{opacity:1}
.ra-btn{width:22px;height:22px;border-radius:4px;border:1px solid var(--border2);background:transparent;color:var(--text3);cursor:pointer;font-size:11px;display:flex;align-items:center;justify-content:center;transition:all .12s}
.ra-btn:hover{background:rgba(255,255,255,.06);color:var(--white)}
.ra-delete:hover{background:rgba(168,32,53,.2);border-color:rgba(168,32,53,.4);color:#e8909a}

/* Time picker */
.time-input{background:transparent;border:none;color:var(--text3);font-size:11px;font-family:'Golos Text',sans-serif;cursor:pointer;outline:none;width:52px;padding:2px 4px;border-radius:3px;transition:background .12s}
.time-input:hover{background:rgba(255,255,255,.05)}
.time-input:focus{background:rgba(255,255,255,.07);color:var(--text)}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;background:#1a1a1a;border:1px solid rgba(42,102,69,.5);color:#7ad4a4;padding:10px 18px;border-radius:7px;font-size:12px;font-weight:500;z-index:9999;opacity:0;transform:translateY(8px);transition:all .25s;pointer-events:none}
.toast.show{opacity:1;transform:translateY(0)}

/* EMPTY ROW */
.empty-row td{text-align:center;padding:32px;color:var(--text3);font-style:italic;font-size:13px}

/* Scrollable wrapper */
.table-wrap{overflow-x:auto;border-radius:12px}

/* Summary footer */
.summary{margin-top:14px;background:var(--frame);border:1px solid var(--border);border-radius:10px;padding:14px 20px;display:flex;gap:24px;align-items:center;flex-wrap:wrap}
.sum-item{display:flex;flex-direction:column;gap:2px}
.sum-label{font-size:8.5px;font-weight:700;letter-spacing:.2em;text-transform:uppercase;color:var(--text3)}
.sum-val{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:700;color:var(--white)}
.sum-sep{width:1px;height:32px;background:var(--border2)}
.sum-chips{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
.sum-chip{font-size:10px;font-weight:600;padding:2px 9px;border-radius:4px}
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div style="display:flex;align-items:center;gap:14px">
    <div class="tb-logo">Gray <span>Cardinal</span></div>
    <div style="width:1px;height:18px;background:var(--border2)"></div>
    <div style="font-size:11px;color:var(--text3)">–ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω</div>
  </div>
  <div class="tb-actions">
    <button class="btn btn-reset" onclick="resetAll()">‚Ü∫ –°–±—Ä–æ—Å–∏—Ç—å</button>
    <button class="btn btn-save" onclick="saveData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="btn btn-add" onclick="addRow()">+ –°—Ç—Ä–æ–∫–∞</button>
  </div>
</div>

<!-- FILTERS -->
<div class="filters">
  <span class="filter-label">–§–∏–ª—å—Ç—Ä:</span>
  <select class="filter-select" id="filter-status" onchange="applyFilters()">
    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
    <option value="idea">–ò–¥–µ—è</option>
    <option value="tz">–¢–ó –≥–æ—Ç–æ–≤–æ</option>
    <option value="prod">–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ</option>
    <option value="done">–ì–æ—Ç–æ–≤–æ</option>
    <option value="pub">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>
  </select>
  <select class="filter-select" id="filter-rubric" onchange="applyFilters()">
    <option value="">–í—Å–µ —Ä—É–±—Ä–∏–∫–∏</option>
    <option value="life">Lifestyle</option>
    <option value="prod">–ü—Ä–æ–¥—É–∫—Ç</option>
    <option value="promo">–ê–∫—Ü–∏—è</option>
    <option value="ugc">UGC</option>
    <option value="edu">–û–±—É—á–µ–Ω–∏–µ</option>
    <option value="bts">BTS</option>
    <option value="news">–ù–æ–≤–æ—Å—Ç–∏</option>
    <option value="eng">–í–æ–≤–ª–µ—á–µ–Ω–∏–µ</option>
  </select>
  <select class="filter-select" id="filter-who" onchange="applyFilters()">
    <option value="">–í—Å–µ</option>
    <option value="katya">–ö–∞—Ç—è</option>
    <option value="erik">–≠—Ä–∏–∫</option>
  </select>
  <div class="filter-sep"></div>
  <select class="filter-select" id="filter-week" onchange="applyFilters()">
    <option value="">–í—Å–µ –Ω–µ–¥–µ–ª–∏</option>
    <option value="1">–ù–µ–¥–µ–ª—è 1</option>
    <option value="2">–ù–µ–¥–µ–ª—è 2</option>
    <option value="3">–ù–µ–¥–µ–ª—è 3</option>
    <option value="4">–ù–µ–¥–µ–ª—è 4</option>
  </select>
  <div style="margin-left:auto;font-size:10px;color:var(--text3)" id="row-count"></div>
</div>

<!-- WEEK TABS -->
<div class="week-tabs" id="week-tabs">
  <div class="week-tab active" onclick="switchWeek(0,this)">–í—Å–µ –Ω–µ–¥–µ–ª–∏</div>
  <div class="week-tab" onclick="switchWeek(1,this)">1‚Äì7 –º–∞—Ä—Ç–∞</div>
  <div class="week-tab" onclick="switchWeek(2,this)">8‚Äì14 –º–∞—Ä—Ç–∞</div>
  <div class="week-tab" onclick="switchWeek(3,this)">15‚Äì21 –º–∞—Ä—Ç–∞</div>
  <div class="week-tab" onclick="switchWeek(4,this)">22‚Äì31 –º–∞—Ä—Ç–∞</div>
</div>

<!-- TABLE -->
<div class="main">
<div class="table-wrap">
<table class="cp-table" id="cp-table">
  <thead>
    <tr>
      <th style="width:40px">#</th>
      <th style="width:82px">–î–∞—Ç–∞</th>
      <th style="width:118px">–†—É–±—Ä–∏–∫–∞</th>
      <th style="min-width:220px">–¢–µ–º–∞</th>
      <th style="width:110px">–§–æ—Ä–º–∞—Ç</th>
      <th style="width:130px">–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã</th>
      <th style="width:90px">–¢–µ–∫—Å—Ç</th>
      <th style="width:90px">–í–∏–∑—É–∞–ª</th>
      <th style="width:80px">–ö—Ç–æ</th>
      <th style="width:120px">–°—Ç–∞—Ç—É—Å</th>
      <th style="width:60px">–í—Ä–µ–º—è</th>
      <th style="width:130px">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
      <th style="width:52px"></th>
    </tr>
  </thead>
  <tbody id="table-body">
  </tbody>
</table>
</div>

<!-- SUMMARY -->
<div class="summary" id="summary"></div>
</div>

<div class="toast" id="toast"></div>

<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
const STATUS_OPTIONS = [
  {v:'idea', label:'–ò–¥–µ—è',          cls:'s-idea', icon:'üí°'},
  {v:'tz',   label:'–¢–ó –≥–æ—Ç–æ–≤–æ',     cls:'s-tz',   icon:'üìã'},
  {v:'prod', label:'–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ',cls:'s-prod',  icon:'‚öôÔ∏è'},
  {v:'done', label:'–ì–æ—Ç–æ–≤–æ',        cls:'s-done',  icon:'‚úÖ'},
  {v:'pub',  label:'–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ',  cls:'s-pub',   icon:'üöÄ'},
];
const RUBRIC_OPTIONS = [
  {v:'life',  label:'Lifestyle',  cls:'r-life'},
  {v:'prod',  label:'–ü—Ä–æ–¥—É–∫—Ç',    cls:'r-prod'},
  {v:'promo', label:'–ê–∫—Ü–∏—è',      cls:'r-promo'},
  {v:'ugc',   label:'UGC',        cls:'r-ugc'},
  {v:'edu',   label:'–û–±—É—á–µ–Ω–∏–µ',   cls:'r-edu'},
  {v:'bts',   label:'BTS',        cls:'r-bts'},
  {v:'news',  label:'–ù–æ–≤–æ—Å—Ç–∏',    cls:'r-news'},
  {v:'eng',   label:'–í–æ–≤–ª–µ—á–µ–Ω–∏–µ', cls:'r-eng'},
];
const FORMAT_OPTIONS = [
  {v:'post',  label:'üìÑ –ü–æ—Å—Ç',       cls:'f-post'},
  {v:'car',   label:'üñº –ö–∞—Ä—É—Å–µ–ª—å',   cls:'f-car'},
  {v:'reel',  label:'‚ñ∂ –†–∏–ª—Å',        cls:'f-reel'},
  {v:'stor',  label:'‚¨ú –°—Ç–æ—Ä–∏—Å',     cls:'f-stor'},
  {v:'info',  label:'üìä –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞',cls:'f-info'},
  {v:'vid',   label:'üé¨ –í–∏–¥–µ–æ',      cls:'f-vid'},
];
const WHO_OPTIONS = [
  {v:'katya', label:'–ö–∞—Ç—è', cls:'w-k'},
  {v:'erik',  label:'–≠—Ä–∏–∫', cls:'w-e'},
  {v:'both',  label:'–û–±–∞',  cls:''},
];

const DEFAULT_ROWS = [
  {id:1,week:1,date:'1 –º–∞—Ä',dayName:'—Å–±',weekend:true,title:'–î–∏–≤–∞–Ω ¬´–ú–æ–Ω–∞–∫–æ¬ª ‚Äî —Ü–≤–µ—Ç–∞ –≤–µ—Å–Ω—ã',sub:'–†–µ–Ω–¥–µ—Ä—ã –≤ 4 —Ä–∞—Å—Ü–≤–µ—Ç–∫–∞—Ö: —Ä–æ–∑–∞, —à–∞–ª—Ñ–µ–π, –∫–∞—Ä–∞–º–µ–ª—å, –º–æ–ª–æ—á–Ω—ã–π',rubric:'prod',format:'car',plats:{vk:true,tg:false,ig:true,pin:true},textOk:true,visOk:false,who:'both',status:'done',time:'19:00',note:'–†–µ–Ω–¥–µ—Ä —É –ø–æ–¥—Ä—è–¥—á–∏–∫–∞'},
  {id:2,week:1,date:'3 –º–∞—Ä',dayName:'–ø–Ω',weekend:false,title:'–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –¥–∏–≤–∞–Ω: 5 –≤–æ–ø—Ä–æ—Å–æ–≤',sub:'–ö–∞—Ä—É—Å–µ–ª—å-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π',rubric:'edu',format:'car',plats:{vk:true,tg:true,ig:true,pin:false},textOk:true,visOk:false,who:'both',status:'tz',time:'10:00',note:'–¢–ó –ø–µ—Ä–µ–¥–∞–Ω–æ'},
  {id:3,week:1,date:'5 –º–∞—Ä',dayName:'—Å—Ä',weekend:false,title:'–í–æ—Å–∫—Ä–µ—Å–Ω—ã–π –≤–µ—á–µ—Ä –Ω–∞ –¥–∏–≤–∞–Ω–µ',sub:'–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π lifestyle ‚Äî –ø–ª–µ–¥, –∫–Ω–∏–≥–∞, —É—é—Ç',rubric:'life',format:'post',plats:{vk:true,tg:true,ig:true,pin:false},textOk:true,visOk:false,who:'erik',status:'tz',time:'12:00',note:'–§–æ—Ç–æ –∏–∑ –∞—Ä—Ö–∏–≤–∞'},
  {id:4,week:1,date:'7 –º–∞—Ä',dayName:'–ø—Ç',weekend:false,title:'8 –º–∞—Ä—Ç–∞ ‚Äî —Å–∫–∏–¥–∫–∞ 15% –Ω–∞ –≤—Å—ë',sub:'–ü—Ä–æ–º–æ-–ø–æ—Å—Ç —Å –¥–∞—Ç–æ–π, —É—Å–ª–æ–≤–∏—è–º–∏ –∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–º',rubric:'promo',format:'post',plats:{vk:true,tg:true,ig:true,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'09:00',note:'–ü—Ä–æ–º–æ–∫–æ–¥ –æ—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä—ã'},
  {id:5,week:2,date:'9 –º–∞—Ä',dayName:'–≤—Å',weekend:true,title:'–ö—Ä–æ–≤–∞—Ç—å ¬´–ë–µ—Ä–ª–∏–Ω¬ª ‚Äî –¥–µ—Ç–∞–ª–∏',sub:'–í–∏–¥–µ–æ—Ä–æ–ª–∏–∫ 30 —Å–µ–∫: –º–∞–∫—Ä–æ—Ñ–æ—Ç–æ –æ–±–∏–≤–∫–∏, –Ω–æ–∂–µ–∫, —à–≤–æ–≤',rubric:'prod',format:'vid',plats:{vk:true,tg:false,ig:true,pin:false},textOk:false,visOk:false,who:'erik',status:'idea',time:'14:00',note:'–ù—É–∂–Ω–∞ —Å—ä—ë–º–∫–∞'},
  {id:6,week:2,date:'10 –º–∞—Ä',dayName:'–ø–Ω',weekend:false,title:'–ö–∞–∫ —Ä–æ–∂–¥–∞–µ—Ç—Å—è —Ä–µ–Ω–¥–µ—Ä: BTS',sub:'–°—Ç–æ—Ä–∏—Å-—Å–µ—Ä–∏—è –∏–∑ 6 —Å–ª–∞–π–¥–æ–≤. –ö–∞—Ç—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å',rubric:'bts',format:'stor',plats:{vk:false,tg:false,ig:true,pin:false},textOk:false,visOk:false,who:'katya',status:'idea',time:'18:00',note:'–ö–∞—Ç—è —Å–Ω–∏–º–∞–µ—Ç —Å–∞–º–∞'},
  {id:7,week:2,date:'12 –º–∞—Ä',dayName:'—Å—Ä',weekend:false,title:'–†–µ–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',sub:'–ö–∞—Ä—É—Å–µ–ª—å –∏–∑ 4 —Ñ–æ—Ç–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏',rubric:'ugc',format:'car',plats:{vk:true,tg:true,ig:true,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'11:00',note:'–§–æ—Ç–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É –ê–ª–µ–∫—Å–∞–Ω–¥—Ä—ã'},
  {id:8,week:2,date:'12 –º–∞—Ä',dayName:'—Å—Ä',weekend:false,title:'–ö–∞–∫–æ–π —Ü–≤–µ—Ç –¥–∏–≤–∞–Ω–∞ –≤—ã–±—Ä–∞—Ç—å?',sub:'–û–ø—Ä–æ—Å: 4 —Ä–µ–Ω–¥–µ—Ä–∞, –∞—É–¥–∏—Ç–æ—Ä–∏—è –≥–æ–ª–æ—Å—É–µ—Ç',rubric:'eng',format:'post',plats:{vk:true,tg:false,ig:true,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'20:00',note:'–û–ø—Ä–æ—Å –í–ö–æ–Ω—Ç–∞–∫—Ç–µ'},
  {id:9,week:3,date:'15 –º–∞—Ä',dayName:'—Å–±',weekend:true,title:'–ü—É—Ñ ¬´–°—Ç–æ–∫–≥–æ–ª—å–º¬ª ‚Äî –¥–µ—Ç–∞–ª–∏',sub:'–§–æ–∫—É—Å –Ω–∞ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã. 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–∞—Å—Ü–≤–µ—Ç–æ–∫',rubric:'prod',format:'car',plats:{vk:false,tg:false,ig:true,pin:true},textOk:false,visOk:false,who:'both',status:'idea',time:'11:00',note:'‚Äî'},
  {id:10,week:3,date:'17 –º–∞—Ä',dayName:'–ø–Ω',weekend:false,title:'–î–∏–≤–∞–Ω-–∫–Ω–∏–∂–∫–∞ vs –µ–≤—Ä–æ–∫–Ω–∏–∂–∫–∞',sub:'–ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤',rubric:'edu',format:'info',plats:{vk:true,tg:true,ig:false,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'10:00',note:'‚Äî'},
  {id:11,week:3,date:'19 –º–∞—Ä',dayName:'—Å—Ä',weekend:false,title:'–í–µ—Å–Ω–∞ –¥–æ–º–∞ ‚Äî –º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç–∏–ª—å',sub:'–†–∏–ª—Å 20 —Å–µ–∫. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ —Å –¥–∏–≤–∞–Ω–æ–º',rubric:'life',format:'reel',plats:{vk:true,tg:false,ig:true,pin:false},textOk:false,visOk:false,who:'erik',status:'idea',time:'18:30',note:'–ù–æ–≤–∞—è —Å—ä—ë–º–∫–∞'},
  {id:12,week:3,date:'21 –º–∞—Ä',dayName:'–ø—Ç',weekend:false,title:'–ê–Ω–æ–Ω—Å: –∫–æ–µ-—á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ üëÄ',sub:'–ò–Ω—Ç—Ä–∏–≥—É—é—â–∏–π —Ç–∏–∑–µ—Ä –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è',rubric:'news',format:'stor',plats:{vk:false,tg:true,ig:true,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'20:00',note:'–ò–Ω—Ñ–æ –æ—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä—ã'},
  {id:13,week:4,date:'24 –º–∞—Ä',dayName:'–ø–Ω',weekend:false,title:'–ö—Ä–µ—Å–ª–æ ¬´–õ–∏–æ–Ω¬ª ‚Äî —Ü–µ–Ω–∏–º –¥–µ—Ç–∞–ª–∏',sub:'–ü–æ—Å—Ç —Å 3 —Ñ–æ—Ç–æ: –æ–±—â–∏–π –≤–∏–¥ + 2 –¥–µ—Ç–∞–ª—å–Ω—ã—Ö',rubric:'prod',format:'post',plats:{vk:true,tg:false,ig:true,pin:true},textOk:false,visOk:false,who:'both',status:'idea',time:'12:00',note:'–¶–µ–Ω—É —É—Ç–æ—á–Ω–∏—Ç—å'},
  {id:14,week:4,date:'26 –º–∞—Ä',dayName:'—Å—Ä',weekend:false,title:'–í–∞—à –¥–∏–≤–∞–Ω ‚Äî –ø—Ä–∏—à–ª–∏—Ç–µ —Ñ–æ—Ç–æ',sub:'–í–æ–≤–ª–µ–∫–∞—é—â–∏–π –ø–æ—Å—Ç —Å –ø—Ä–∏–∑—ã–≤–æ–º –∑–∞ —Å–∫–∏–¥–∫—É 5%',rubric:'ugc',format:'post',plats:{vk:true,tg:true,ig:true,pin:false},textOk:false,visOk:false,who:'erik',status:'idea',time:'11:00',note:'–ê–∫—Ü–∏—é —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å'},
  {id:15,week:4,date:'28 –º–∞—Ä',dayName:'–ø—Ç',weekend:false,title:'–ö–∞–∫–æ–π –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å –≤—ã–±—Ä–∞—Ç—å',sub:'–ü—Ä—É–∂–∏–Ω—ã vs –ø–µ–Ω–∞ vs –∫–æ–º–±–∏ ‚Äî —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞',rubric:'edu',format:'car',plats:{vk:true,tg:true,ig:false,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'10:00',note:'‚Äî'},
  {id:16,week:4,date:'29 –º–∞—Ä',dayName:'—Å–±',weekend:true,title:'–°—É–±–±–æ—Ç–∞ ‚Äî –≤—ã—Å–ø–∞—Ç—å—Å—è –Ω–∞–∫–æ–Ω–µ—Ü',sub:'–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ —Ñ–æ—Ç–æ –∫—Ä–æ–≤–∞—Ç–∏, —É—Ç—Ä–æ, –∫–æ—Ñ–µ',rubric:'life',format:'post',plats:{vk:false,tg:true,ig:true,pin:true},textOk:false,visOk:false,who:'erik',status:'idea',time:'11:00',note:'‚Äî'},
  {id:17,week:4,date:'31 –º–∞—Ä',dayName:'–ø–Ω',weekend:false,title:'–ò—Ç–æ–≥–∏ –º–∞—Ä—Ç–∞ ‚Äî —Å–ø–∞—Å–∏–±–æ!',sub:'–¢—ë–ø–ª—ã–π –∏—Ç–æ–≥–æ–≤—ã–π –ø–æ—Å—Ç. –¶–∏—Ñ—Ä—ã, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å, —Ç–∏–∑–µ—Ä',rubric:'news',format:'post',plats:{vk:true,tg:true,ig:true,pin:false},textOk:false,visOk:false,who:'both',status:'idea',time:'12:00',note:'–¶–∏—Ñ—Ä—ã –∏–∑ –æ—Ç—á—ë—Ç–∞'},
];

let rows = [];
let nextId = 100;
let currentWeek = 0;

// ‚îÄ‚îÄ LOAD / SAVE ‚îÄ‚îÄ
function loadData() {
  try {
    const saved = localStorage.getItem('gc_content_plan_v2');
    if (saved) { const d = JSON.parse(saved); rows = d.rows; nextId = d.nextId || 100; }
    else { rows = JSON.parse(JSON.stringify(DEFAULT_ROWS)); }
  } catch(e) { rows = JSON.parse(JSON.stringify(DEFAULT_ROWS)); }
}
function saveData() {
  try {
    localStorage.setItem('gc_content_plan_v2', JSON.stringify({rows, nextId}));
    showToast('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
  } catch(e) { showToast('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è'); }
}
function resetAll() {
  if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ –∏—Å—Ö–æ–¥–Ω—ã–º –¥–∞–Ω–Ω—ã–º?')) return;
  rows = JSON.parse(JSON.stringify(DEFAULT_ROWS));
  nextId = 100;
  localStorage.removeItem('gc_content_plan_v2');
  renderTable();
  showToast('‚Ü∫ –°–±—Ä–æ—à–µ–Ω–æ');
}

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ
function renderTable() {
  const tbody = document.getElementById('table-body');
  const fs = document.getElementById('filter-status').value;
  const fr = document.getElementById('filter-rubric').value;
  const fw = document.getElementById('filter-who').value;

  let filtered = rows.filter(r => {
    if (currentWeek > 0 && r.week !== currentWeek) return false;
    if (fs && r.status !== fs) return false;
    if (fr && r.rubric !== fr) return false;
    if (fw === 'katya' && r.who !== 'katya' && r.who !== 'both') return false;
    if (fw === 'erik'  && r.who !== 'erik'  && r.who !== 'both') return false;
    return true;
  });

  document.getElementById('row-count').textContent = `–ü–æ–∫–∞–∑–∞–Ω–æ: ${filtered.length} –∏–∑ ${rows.length}`;

  if (filtered.length === 0) {
    tbody.innerHTML = `<tr class="empty-row"><td colspan="13">–ù–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–π –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º</td></tr>`;
    renderSummary([]);
    return;
  }

  let html = '';
  let lastWeek = 0;
  filtered.forEach((r, i) => {
    if (r.week !== lastWeek) {
      lastWeek = r.week;
      const wlabels = ['','1‚Äì7 –º–∞—Ä—Ç–∞','8‚Äì14 –º–∞—Ä—Ç–∞','15‚Äì21 –º–∞—Ä—Ç–∞','22‚Äì31 –º–∞—Ä—Ç–∞'];
      html += `<tr class="week-row"><td colspan="13">–ù–µ–¥–µ–ª—è ${r.week} &nbsp;<span>${wlabels[r.week] || ''}</span></td></tr>`;
    }
    const cls = i % 2 === 0 ? 'row-odd' : 'row-even';
    html += buildRow(r, cls, i + 1);
  });

  tbody.innerHTML = html;
  renderSummary(filtered);
}

function buildRow(r, cls, num) {
  const st = STATUS_OPTIONS.find(x=>x.v===r.status) || STATUS_OPTIONS[0];
  const rb = RUBRIC_OPTIONS.find(x=>x.v===r.rubric) || RUBRIC_OPTIONS[0];
  const fm = FORMAT_OPTIONS.find(x=>x.v===r.format) || FORMAT_OPTIONS[0];
  const who = WHO_OPTIONS.find(x=>x.v===r.who) || WHO_OPTIONS[0];

  const whoHtml = r.who === 'both'
    ? `<div style="display:flex;flex-direction:column;gap:3px"><span class="w-k">–ö–∞—Ç—è</span><span class="w-e">–≠—Ä–∏–∫</span></div>`
    : r.who === 'katya' ? `<span class="w-k">–ö–∞—Ç—è</span>` : `<span class="w-e">–≠—Ä–∏–∫</span>`;

  const plats = ['vk','tg','ig','pin'];
  const platLabels = {vk:'–í–ö',tg:'TG',ig:'IG',pin:'PIN'};
  const platCls    = {vk:'p-vk',tg:'p-tg',ig:'p-ig',pin:'p-pin'};
  const platHtml = plats.map(p =>
    `<span class="badge ${platCls[p]} plat-toggle ${r.plats[p] ? '' : 'off'}"
      onclick="togglePlat(${r.id},'${p}')">${platLabels[p]}</span>`
  ).join('');

  return `<tr class="${cls}" data-id="${r.id}" data-week="${r.week}" data-status="${r.status}" data-rubric="${r.rubric}" data-who="${r.who}">
    <td class="c-num">${num}</td>
    <td class="c-date">
      <div class="date-day" contenteditable="true" oninput="updateField(${r.id},'date',this.innerText)">${r.date}</div>
      <div class="date-name ${r.weekend ? 'weekend':''}" contenteditable="true" oninput="updateField(${r.id},'dayName',this.innerText)">${r.dayName}</div>
    </td>
    <td class="cell-select">
      ${buildSelect(r.id, 'rubric', RUBRIC_OPTIONS, r.rubric, 'badge')}
    </td>
    <td>
      <span class="topic-title" contenteditable="true" oninput="updateField(${r.id},'title',this.innerText)">${r.title}</span>
      <span class="topic-sub" contenteditable="true" oninput="updateField(${r.id},'sub',this.innerText)">${r.sub}</span>
    </td>
    <td class="cell-select">
      ${buildSelect(r.id, 'format', FORMAT_OPTIONS, r.format, 'badge')}
    </td>
    <td>
      <div class="plat-tags">${platHtml}</div>
    </td>
    <td>
      <div class="asset-cell">
        <div class="asset-row">
          <div class="asset-check ${r.textOk ? 'checked':''}" onclick="toggleAsset(${r.id},'textOk')">${r.textOk ? '‚úì':''}</div>
          <span>${r.textOk ? '–ì–æ—Ç–æ–≤' : '–ù—É–∂–µ–Ω'}</span>
        </div>
      </div>
    </td>
    <td>
      <div class="asset-cell">
        <div class="asset-row">
          <div class="asset-check ${r.visOk ? 'checked':''}" onclick="toggleAsset(${r.id},'visOk')">${r.visOk ? '‚úì':''}</div>
          <span>${r.visOk ? '–ì–æ—Ç–æ–≤' : '–ù—É–∂–µ–Ω'}</span>
        </div>
      </div>
    </td>
    <td>${whoHtml}</td>
    <td class="cell-select">
      ${buildSelect(r.id, 'status', STATUS_OPTIONS, r.status, 'badge')}
    </td>
    <td>
      <input type="time" class="time-input" value="${r.time}" onchange="updateField(${r.id},'time',this.value)">
    </td>
    <td>
      <span class="note-cell" contenteditable="true" oninput="updateField(${r.id},'note',this.innerText)">${r.note}</span>
    </td>
    <td>
      <div class="row-actions">
        <button class="ra-btn" onclick="duplicateRow(${r.id})" title="–î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å">‚ßâ</button>
        <button class="ra-btn ra-delete" onclick="deleteRow(${r.id})" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
      </div>
    </td>
  </tr>`;
}

function buildSelect(rowId, field, options, currentVal, badgeType) {
  const current = options.find(x => x.v === currentVal) || options[0];
  const optionsHtml = options.map(o =>
    `<div class="cs-option ${o.v === currentVal ? 'selected':''}" onclick="selectOption(${rowId},'${field}','${o.v}',this)">
      <span class="badge ${o.cls}">${o.icon ? o.icon + ' ' : ''}${o.label}</span>
    </div>`
  ).join('');
  return `<div class="custom-select" id="sel-${rowId}-${field}" onclick="toggleDropdown(event,'sel-${rowId}-${field}')">
    <div class="cs-trigger">
      <span class="badge ${current.cls}">${current.icon ? current.icon + ' ' : ''}${current.label}</span>
      <span class="cs-arrow">‚ñæ</span>
    </div>
    <div class="cs-dropdown">${optionsHtml}</div>
  </div>`;
}

// ‚îÄ‚îÄ INTERACTIONS ‚îÄ‚îÄ
function toggleDropdown(e, id) {
  e.stopPropagation();
  const sel = document.getElementById(id);
  const wasOpen = sel.classList.contains('open');
  document.querySelectorAll('.custom-select.open').forEach(s => s.classList.remove('open'));
  if (!wasOpen) sel.classList.add('open');
}
document.addEventListener('click', () => {
  document.querySelectorAll('.custom-select.open').forEach(s => s.classList.remove('open'));
});

function selectOption(rowId, field, val, el) {
  const row = rows.find(r => r.id === rowId);
  if (!row) return;
  row[field] = val;
  document.querySelectorAll('.custom-select.open').forEach(s => s.classList.remove('open'));
  renderTable();
  autoSave();
}

function updateField(rowId, field, val) {
  const row = rows.find(r => r.id === rowId);
  if (row) { row[field] = val; autoSave(); }
}

function toggleAsset(rowId, field) {
  const row = rows.find(r => r.id === rowId);
  if (!row) return;
  row[field] = !row[field];
  renderTable();
  autoSave();
}

function togglePlat(rowId, plat) {
  const row = rows.find(r => r.id === rowId);
  if (!row) return;
  row.plats[plat] = !row.plats[plat];
  renderTable();
  autoSave();
}

function addRow() {
  const newRow = {
    id: nextId++,
    week: currentWeek || 1,
    date: '‚Äî –º–∞—Ä',
    dayName: '‚Äî',
    weekend: false,
    title: '–ù–æ–≤–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è',
    sub: '–û–ø–∏—Å–∞–Ω–∏–µ',
    rubric: 'life',
    format: 'post',
    plats: {vk:true,tg:false,ig:true,pin:false},
    textOk: false,
    visOk: false,
    who: 'both',
    status: 'idea',
    time: '12:00',
    note: '‚Äî'
  };
  rows.push(newRow);
  renderTable();
  autoSave();
  showToast('‚úö –°—Ç—Ä–æ–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
}

function deleteRow(rowId) {
  rows = rows.filter(r => r.id !== rowId);
  renderTable();
  autoSave();
  showToast('‚úï –£–¥–∞–ª–µ–Ω–æ');
}

function duplicateRow(rowId) {
  const row = rows.find(r => r.id === rowId);
  if (!row) return;
  const copy = JSON.parse(JSON.stringify(row));
  copy.id = nextId++;
  copy.title = copy.title + ' (–∫–æ–ø–∏—è)';
  const idx = rows.findIndex(r => r.id === rowId);
  rows.splice(idx + 1, 0, copy);
  renderTable();
  autoSave();
  showToast('‚ßâ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–æ');
}

function switchWeek(week, el) {
  currentWeek = week;
  document.querySelectorAll('.week-tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  renderTable();
}

function applyFilters() { renderTable(); }

// ‚îÄ‚îÄ SUMMARY ‚îÄ‚îÄ
function renderSummary(filtered) {
  const total = filtered.length;
  const byStatus = {};
  const byRub = {};
  STATUS_OPTIONS.forEach(s => byStatus[s.v] = 0);
  RUBRIC_OPTIONS.forEach(r => byRub[r.v] = 0);
  filtered.forEach(r => { byStatus[r.status]++; byRub[r.rubric]++; });

  let chips = STATUS_OPTIONS.filter(s => byStatus[s.v] > 0).map(s =>
    `<span class="sum-chip badge ${s.cls}">${s.icon} ${byStatus[s.v]}</span>`
  ).join('');
  let rubs = RUBRIC_OPTIONS.filter(r => byRub[r.v] > 0).map(r =>
    `<span class="sum-chip badge ${r.cls}">${r.label}: ${byRub[r.v]}</span>`
  ).join('');

  document.getElementById('summary').innerHTML = `
    <div class="sum-item"><div class="sum-label">–ü—É–±–ª–∏–∫–∞—Ü–∏–π</div><div class="sum-val">${total}</div></div>
    <div class="sum-sep"></div>
    <div class="sum-item"><div class="sum-label">–ü–æ —Å—Ç–∞—Ç—É—Å—É</div><div class="sum-chips">${chips}</div></div>
    <div class="sum-sep"></div>
    <div class="sum-item"><div class="sum-label">–ü–æ —Ä—É–±—Ä–∏–∫–∞–º</div><div class="sum-chips">${rubs}</div></div>`;
}

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2200);
}

// Autosave debounce
let saveTimer;
function autoSave() {
  clearTimeout(saveTimer);
  saveTimer = setTimeout(saveData, 1500);
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
loadData();
renderTable();
</script>
</body>
</html>
